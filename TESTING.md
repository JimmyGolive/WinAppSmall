# 測試指南

## 如何測試 WinAppSmall

### 準備工作

1. **編譯專案**
   ```bash
   cd WinAppSmall
   dotnet build -c Release
   ```

2. **找到可執行檔**
   ```
   WinAppSmall/bin/Release/net8.0-windows/WinAppSmall.exe
   ```

### 測試步驟

#### 測試 1: 基本功能測試 - 記事本

1. 運行 WinAppSmall.exe
2. 在「程式名稱」欄位輸入：`notepad`（會自動添加 .exe）
3. 點擊「添加」按鈕
4. 開啟 Windows 記事本（Notepad）
5. 在記事本中輸入一些文字
6. 點擊記事本視窗右上角的 X 按鈕
7. **預期結果**：記事本應該最小化到工作列，而不是關閉
8. 從工作列點擊記事本圖示
9. **驗證**：之前輸入的文字應該還在

#### 測試 2: 多個程式監控

1. 在 WinAppSmall 中添加以下程式：
   - `calc`（計算機）
   - `mspaint`（小畫家）
2. 分別開啟計算機和小畫家
3. 嘗試關閉這兩個程式
4. **預期結果**：兩個程式都應該最小化而不是關閉

#### 測試 3: 系統托盤功能

1. 點擊 WinAppSmall 主視窗的 X 按鈕
2. **預期結果**：WinAppSmall 應該最小化到系統托盤（右下角）
3. 在系統托盤中找到 WinAppSmall 圖示
4. 雙擊圖示
5. **預期結果**：主視窗重新顯示
6. 右鍵點擊系統托盤圖示
7. **預期結果**：顯示選單（顯示/退出）

#### 測試 4: 程式移除

1. 在列表中選擇一個程式
2. 點擊「移除」按鈕
3. 嘗試關閉該程式
4. **預期結果**：程式應該正常關閉（不再被攔截）

#### 測試 5: 配置持久化

1. 添加幾個程式到監控列表
2. 關閉 WinAppSmall（點擊系統托盤的「退出」）
3. 重新啟動 WinAppSmall
4. **預期結果**：之前添加的程式應該仍在列表中

#### 測試 6: 錯誤處理

1. 嘗試添加一個不存在的程式名稱：`nonexistent.exe`
2. **預期結果**：程式應該能正常添加（只是狀態顯示為「未運行」）
3. 嘗試添加空白名稱
4. **預期結果**：應該顯示提示訊息

### 已知行為

#### 可以正常攔截的程式
- ✅ 記事本（notepad.exe）
- ✅ 計算機（calc.exe）
- ✅ 小畫家（mspaint.exe）
- ✅ 檔案總管視窗（explorer.exe）- 注意：會最小化所有檔案總管視窗
- ✅ 大部分標準 Windows 應用程式

#### 可能無法完全攔截的程式
- ⚠️ 某些現代 UWP 應用程式
- ⚠️ 以更高權限運行的程式（需要以管理員身份運行 WinAppSmall）
- ⚠️ 某些瀏覽器可能有特殊的關閉機制
- ⚠️ 遊戲程式可能有自定義的視窗管理

### 疑難排解

#### 問題：程式沒有被最小化，還是關閉了

**解決方案：**
1. 確認程式名稱正確（包括 .exe）
2. 檢查「狀態」欄位是否顯示該程式正在運行
3. 嘗試以管理員身份運行 WinAppSmall
4. 某些程式可能使用特殊的關閉機制，無法被攔截

#### 問題：找不到系統托盤圖示

**解決方案：**
1. 檢查系統托盤是否被隱藏（點擊右下角的向上箭頭）
2. 確認程式正在運行（檢查工作管理員）

#### 問題：狀態一直顯示「未運行」

**解決方案：**
1. 確認程式名稱拼寫正確
2. 確認目標程式確實正在運行
3. 等待 1-2 秒讓監控系統更新

### 效能觀察

在測試期間，可以監控以下項目：

1. **CPU 使用率**
   - 正常情況下應該非常低（< 1%）
   - 打開工作管理員，找到 WinAppSmall.exe
   - 觀察 CPU 使用率

2. **記憶體使用**
   - 應該保持在 20-50 MB 左右
   - 不應該持續增長

3. **回應速度**
   - 點擊關閉按鈕後，應該立即最小化
   - UI 操作應該流暢無延遲

### 測試報告模板

```
測試日期：________
測試環境：Windows __ (10/11)
.NET 版本：________

| 測試項目 | 結果 | 備註 |
|---------|------|------|
| 基本功能 - 記事本 | ✅/❌ | |
| 多程式監控 | ✅/❌ | |
| 系統托盤功能 | ✅/❌ | |
| 程式移除 | ✅/❌ | |
| 配置持久化 | ✅/❌ | |
| 錯誤處理 | ✅/❌ | |

發現的問題：
1. 
2. 

建議改進：
1. 
2. 
```

### 進階測試

#### 壓力測試
1. 添加 10+ 個程式到監控列表
2. 同時運行所有這些程式
3. 快速連續點擊多個程式的關閉按鈕
4. **預期結果**：所有程式都應該正確最小化

#### 長時間運行測試
1. 啟動 WinAppSmall 並添加常用程式
2. 讓程式運行 24 小時以上
3. 定期檢查記憶體使用和 CPU 使用率
4. **預期結果**：無記憶體洩漏，效能穩定

### 自動化測試（可選）

如果要編寫自動化測試，可以使用以下工具：
- UI Automation Framework
- Windows Application Driver (WinAppDriver)
- PowerShell 腳本

範例 PowerShell 測試腳本：

```powershell
# 啟動記事本
Start-Process notepad

# 等待視窗出現
Start-Sleep -Seconds 2

# 獲取記事本視窗
$notepad = Get-Process notepad | Select-Object -First 1

# 檢查視窗是否存在
if ($notepad.MainWindowHandle -ne 0) {
    Write-Host "記事本已啟動" -ForegroundColor Green
} else {
    Write-Host "記事本啟動失敗" -ForegroundColor Red
}

# 關閉記事本進行測試
# ... 更多測試邏輯
```
